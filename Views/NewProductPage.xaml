<ContentPage
    x:Class="SnapLabel.Views.NewProductPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:constant="clr-namespace:SnapLabel.Constants"
    xmlns:controls="clr-namespace:SnapLabel.Controls"
    xmlns:editors="clr-namespace:Syncfusion.Maui.Inputs;assembly=Syncfusion.Maui.Inputs"
    xmlns:mct="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
    xmlns:sync="clr-namespace:Syncfusion.Maui.Core;assembly=Syncfusion.Maui.Core"
    xmlns:vm="clr-namespace:SnapLabel.ViewModels"
    x:Name="NewProdPage"
    Title="New Product"
    x:DataType="vm:NewProductPageViewModel">

    <ContentPage.Behaviors>
        <mct:EventToCommandBehavior
            BindingContext="{Binding Path=BindingContext, Source={x:Reference NewProdPage}, x:DataType=ContentPage}"
            Command="{Binding GetConnctedDeicesCommand}"
            EventName="NavigatedTo" />
    </ContentPage.Behaviors>

    <ContentPage.ToolbarItems>
        <ToolbarItem Command="{Binding SaveProductCommand}">
            <ToolbarItem.IconImageSource>
                <FontImageSource
                    FontFamily="Mat"
                    Glyph="{Static constant:FontsConstants.Save}"
                    Color="{AppThemeBinding Dark={StaticResource White},
                                            Light={StaticResource Black}}" />
            </ToolbarItem.IconImageSource>
        </ToolbarItem>
        <ToolbarItem
            controls:ToolbarItemExtensions.IsVisible="{x:Binding IsDeviceConnected}"
            BindingContext="{Binding Path=BindingContext, Source={x:Reference NewProdPage}, x:DataType=ContentPage}"
            Command="{Binding PrintProductCommand}">
            <ToolbarItem.IconImageSource>
                <FontImageSource
                    FontFamily="Mat"
                    Glyph="{Static constant:FontsConstants.Print}"
                    Color="{AppThemeBinding Dark={StaticResource White},
                                            Light={StaticResource Black}}" />
            </ToolbarItem.IconImageSource>
        </ToolbarItem>
    </ContentPage.ToolbarItems>

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="5">
            <!--  Store  -->
            <sync:SfTextInputLayout Hint="Store">
                <editors:SfComboBox
                    DisplayMemberPath="Name"
                    IsClearButtonVisible="False"
                    IsEditable="false"
                    ItemsSource="{x:Binding Stores}"
                    Placeholder="Selecta store"
                    SelectedItem="{x:Binding Store}"
                    TextColor="{x:AppThemeBinding Dark={StaticResource White},
                                                  Light={StaticResource Black}}"
                    TextMemberPath="Name" />
            </sync:SfTextInputLayout>
            <!--  Name  -->
            <sync:SfTextInputLayout Hint="Name">
                <Entry
                    Keyboard="Text"
                    Text="{x:Binding Product.Name}"
                    VerticalTextAlignment="Center" />
            </sync:SfTextInputLayout>

            <!--  Desc  -->
            <sync:SfTextInputLayout Hint="Descrption">
                <Entry
                    Keyboard="Text"
                    Text="{x:Binding Product.Description}"
                    VerticalTextAlignment="Center" />
            </sync:SfTextInputLayout>

            <!--  Price  -->
            <sync:SfTextInputLayout Hint="Price">
                <Entry
                    Keyboard="Numeric"
                    Text="{x:Binding Product.Price}"
                    VerticalTextAlignment="Center" />
            </sync:SfTextInputLayout>

            <!--  Quantity  -->
            <sync:SfTextInputLayout Hint="Quantity">
                <Entry
                    Keyboard="Numeric"
                    Text="{x:Binding Product.Quantity}"
                    VerticalTextAlignment="Center" />
            </sync:SfTextInputLayout>

            <HorizontalStackLayout IsVisible="{x:Binding IsDeviceConnected}" Spacing="10">
                <Label
                    Margin="0,0,0,4"
                    FontAttributes="Italic"
                    FontSize="14"
                    Text="Draw your own image: "
                    VerticalTextAlignment="Center" />
                <Switch IsToggled="{x:Binding IsCustomImage}" OnColor="Green" />
            </HorizontalStackLayout>
            <!--  Image Preview  -->
            <Border
                Margin="0,20,0,0"
                BackgroundColor="#eee"
                HeightRequest="300"
                Stroke="#ccc"
                WidthRequest="300">
                <controls:SmartImage
                    Margin="5"
                    Aspect="AspectFill"
                    DynamicSource="{x:Binding Product.ImageBytes}"
                    Placeholder="camera.png" />
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="8" />
                </Border.StrokeShape>
                <Border.Shadow>
                    <Shadow
                        Brush="{x:AppThemeBinding Dark={StaticResource White},
                                                  Light={StaticResource Black}}"
                        Opacity="0.4"
                        Radius="3"
                        Offset="5,5" />
                </Border.Shadow>
                <Border.GestureRecognizers>
                    <TapGestureRecognizer Command="{x:Binding CaptureImageCommand}" />
                </Border.GestureRecognizers>
            </Border>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>